{
  "info": {
    "_postman_id": "2d6d0ea5-13ab-4a95-9a34-e83c2c5d4b4a",
    "name": "Bisky API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:3000" },
    { "key": "email", "value": "seed@bisky.dev" },
    { "key": "password", "value": "SeedPass123!" },
    { "key": "accessToken", "value": "" },
    { "key": "showId", "value": "" },
    { "key": "episodeId", "value": "" }
  ],
  "item": [
    {
      "name": "Health",
      "item": [
        {
          "name": "GET /health",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/health"
          }
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "POST /auth/register",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\"\n}"
            },
            "url": "{{baseUrl}}/auth/register"
          }
        },
        {
          "name": "POST /auth/login",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.access_token) {",
                  "  pm.collectionVariables.set('accessToken', json.access_token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\"\n}"
            },
            "url": "{{baseUrl}}/auth/login"
          }
        },
        {
          "name": "POST /auth/forgot-password",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{email}}\"\n}"
            },
            "url": "{{baseUrl}}/auth/forgot-password"
          }
        }
      ]
    },
    {
      "name": "Shows",
      "item": [
        {
          "name": "POST /shows",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.internalShowId) {",
                  "  pm.collectionVariables.set('showId', json.internalShowId);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"titlePreferred\": \"Frieren: Beyond Journey's End\",\n  \"titleOriginal\": \"Sousou no Frieren\",\n  \"altTitles\": [\"Frieren\"],\n  \"type\": \"anime\",\n  \"status\": \"ongoing\",\n  \"synopsis\": \"An elf mage reflects on life and time.\",\n  \"startDate\": \"2023-09-29\",\n  \"posterUrl\": \"https://example.com/poster.jpg\",\n  \"bannerUrl\": \"https://example.com/banner.jpg\",\n  \"seasonCount\": 1,\n  \"episodeCount\": 28,\n  \"externalIds\": {\n    \"anilist\": 154587\n  }\n}"
            },
            "url": "{{baseUrl}}/shows"
          }
        },
        {
          "name": "GET /shows",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/shows"
          }
        },
        {
          "name": "GET /shows/:internalShowId",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/shows/{{showId}}"
          }
        },
        {
          "name": "PUT /shows/:internalShowId",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"titlePreferred\": \"Frieren\",\n  \"titleOriginal\": \"Sousou no Frieren\",\n  \"altTitles\": [\"Frieren\"],\n  \"type\": \"anime\",\n  \"status\": \"ongoing\",\n  \"synopsis\": \"Updated synopsis\",\n  \"startDate\": \"2023-09-29\",\n  \"posterUrl\": \"https://example.com/poster.jpg\",\n  \"bannerUrl\": \"https://example.com/banner.jpg\",\n  \"seasonCount\": 1,\n  \"episodeCount\": 28,\n  \"externalIds\": {\n    \"anilist\": 154587\n  }\n}"
            },
            "url": "{{baseUrl}}/shows/{{showId}}"
          }
        },
        {
          "name": "DELETE /shows/:internalShowId",
          "request": {
            "method": "DELETE",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/shows/{{showId}}"
          }
        }
      ]
    },
    {
      "name": "Episodes",
      "item": [
        {
          "name": "POST /episodes",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.internalEpisodeId) {",
                  "  pm.collectionVariables.set('episodeId', json.internalEpisodeId);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"showId\": \"{{showId}}\",\n  \"seasonNumber\": 1,\n  \"episodeNumber\": 1,\n  \"title\": \"Journey's End\",\n  \"airDate\": \"2023-09-29\",\n  \"runtimeMinutes\": 24,\n  \"externalIds\": {\n    \"anilist\": 1\n  }\n}"
            },
            "url": "{{baseUrl}}/episodes"
          }
        },
        {
          "name": "GET /episodes",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/episodes"
          }
        },
        {
          "name": "GET /episodes/:internalEpisodeId",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/episodes/{{episodeId}}"
          }
        },
        {
          "name": "PUT /episodes/:internalEpisodeId",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"showId\": \"{{showId}}\",\n  \"seasonNumber\": 1,\n  \"episodeNumber\": 1,\n  \"title\": \"Journey's End (Updated)\",\n  \"airDate\": \"2023-09-29\",\n  \"runtimeMinutes\": 24,\n  \"externalIds\": {\n    \"anilist\": 1\n  }\n}"
            },
            "url": "{{baseUrl}}/episodes/{{episodeId}}"
          }
        },
        {
          "name": "DELETE /episodes/:internalEpisodeId",
          "request": {
            "method": "DELETE",
            "header": [
              { "key": "Authorization", "value": "Bearer {{accessToken}}" }
            ],
            "url": "{{baseUrl}}/episodes/{{episodeId}}"
          }
        }
      ]
    },
    {
      "name": "Metadata",
      "item": [
        {
          "name": "GET /metadata/search",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/metadata/search?query=frieren&type=anidb&page=1&limit=10"
          }
        },
        {
          "name": "POST /metadata/show",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"provider\": \"anidb\",\n  \"externalId\": \"16498\",\n  \"titlePreferred\": \"Sousou no Frieren\",\n  \"titleOriginal\": \"葬送のフリーレン\",\n  \"type\": \"anime\",\n  \"score\": 95.3,\n  \"description\": \"After the hero party defeats the Demon King...\",\n  \"bannerUrl\": \"https://s4.anilist.co/file/anilistcdn/media/anime/banner/16498.jpg\"\n}"
            },
            "url": "{{baseUrl}}/metadata/show"
          }
        },
        {
          "name": "GET /metadata/show/:externalId",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/metadata/show/16498?type=anidb"
          }
        },
        {
          "name": "GET /metadata/episodes/:externalId",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/metadata/episodes/16498?type=anidb&page=1&limit=25"
          }
        }
      ]
    }
  ]
}
